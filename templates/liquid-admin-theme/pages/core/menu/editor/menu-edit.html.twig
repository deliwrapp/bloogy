{% extends 'liquid-admin-theme/layout-admin.html.twig' %}

{% block title %}ADMIN MENU EDIT{% endblock %}

{% block mainContent %}
    <section class="col -col-4 -md12 -sm12 -xs12">
        <a class="btn -block" href="{{ path('editor_menu_list') }}">back to list</a>
        <div class="panel -bg-white -b-rounded-md -shad-8 -w-f">
            <div class="-panel-header -text-center -flex -justify-space-evenly">
                {% if menu is defined and menu is not null %}
                    <a 
                        class="btn tooltip tooltip-left -tertiary btn btn-action s-circle -light -hover -shad-12 -shad-14-h"
                        data-tooltip="show"
                        href="{{ path('editor_menu_show', { 'id': menu.id }) }}"
                    >
                        <i class="fa-solid fa-eye fa-2x"></i>
                    </a>
                    {{ include('liquid-admin-theme/pages/core/menu/editor/_delete_form.html.twig') }}
                {% endif %}
            </div>
            {{ form_start(form, {'attr': {'class': '-w-f'}}) }}
                <section class="-panel-body -flex -wrap">
                    <div class="col -col-12">
                        {{ form_label(form.name, null, {
                            'label_attr': {'class': '-t-c -t-bld -color-dark'}
                        }) }}
                        <small>{{ form_help(form.name) }}</small>
                        {{ form_errors(form.name) }}
                        <div class="form-element has-icon-right">
                            {{ form_widget(form.name, {'attr': {'class': 'form-field -shad-12-h'}}) }}
                            <i class="form-icon fa-solid fa-heading"></i>
                        </div>
                    </div>

                    <div class="col -col-12">
                        <small>{{ form_help(form.position) }}</small>
                        {{ form_errors(form.position) }}
                        <div class="form-element">
                            {{ form_label(form.position, null, {
                                'label_attr': {'class': '-t-c -t-bld -color-dark'}
                            }) }}
                            <div class="-sm9">
                                {{ form_widget(form.position, {'attr': {'class': 'form-select -shad-12'}}) }}
                            </div>
                        </div>
                    </div>
                    <div class="col -col-12">
                        <small>{{ form_help(form.locale) }}</small>
                        {{ form_errors(form.locale) }}
                        <div class="form-element">
                            {{ form_label(form.locale, null, {
                                'label_attr': {'class': '-t-c -t-bld -color-dark'}
                            }) }}
                            <div class="-sm9">
                                {{ form_widget(form.locale, {'attr': {'class': 'form-select -shad-12'}}) }}
                            </div>
                        </div>
                    </div>
                    <div class="col -col-6">
                        <div class="form-element">
                            <label class="switch">
                                {{ form_widget(form.isMainMenu) }}
                                <i class="form-icon -shad-12"></i>
                                <span class="form-field-msg -t-c -t-bld -color-dark">Main menu</span>
                            </label>
                        </div>
                        <small>{{ form_help(form.isMainMenu) }}</small>
                        {{ form_errors(form.isMainMenu) }} 
                    </div>
                    <div class="col -col-6">
                        <div class="form-element">
                            <label class="switch">
                                {{ form_widget(form.isPublished) }}
                                <i class="form-icon -shad-12"></i>
                                <span class="form-field-msg -t-c -t-bld -color-dark">Published</span>
                            </label>
                        </div>
                        <small>{{ form_help(form.isPublished) }}</small>
                        {{ form_errors(form.isPublished) }} 
                    </div>
                </section>

                <section class="-panel-footer -text-center ">
                    {{ form_widget(form.submit, {'attr': {'class': '-t-u -t-bld btn -primary -hover -block -shad-13 -shad-19-h -btn-bordered -b-rounded-xl'}}) }}
                </section>
            {{ form_end(form) }}
        </div>
    </section>
    {% if menu is defined  %}
        <section class="col -col-8 -md12 -sm12 -xs12" id="menu-items-list">    
            <div class="tile -tile-compact -w-f -shad-12">
                <div class="-tile-content">
                    <div class="-tile-title -t-bld">
                        MENU ITEMS LIST
                    </div>
                    <div class="-tile-subtitle">
                        Create a new Item
                    </div>
                </div>
                <div class="-tile-action">
                    <a 
                        class="btn -primary btn-link btn-block -btn-lg tooltip -tooltip-bottom"
                        data-tooltip="Add Page Link"
                        href="{{ path('editor_menu_item_create', { 'menuId': menu.id, 'type': 'page' }) }}">
                        <span>Page</span>
                        <i class="fa-solid fa-plus"></i> 
                    </a>
                    <a 
                        class="btn -success btn-link btn-block -btn-lg tooltip -tooltip-bottom"
                        data-tooltip="Add Internal Link"
                        href="{{ path('editor_menu_item_create', { 'menuId': menu.id, 'type': 'internal' }) }}">
                        <span>Internal</span>
                        <i class="fa-solid fa-plus"></i> 
                    </a>
                    <a 
                        class="btn -tertiary btn-link btn-block -btn-lg tooltip -tooltip-bottom"
                        data-tooltip="Add External Link"
                        href="{{ path('editor_menu_item_create', { 'menuId': menu.id, 'type': 'external' }) }}">
                        <span>External</span>
                        <i class="fa-solid fa-plus"></i> 
                    </a>
                </div>
            </div>
            {% if menu.menuItems is defined and menu.menuItems is not empty %}
                <section>
                    <table class="table -striped -hover -responsive -inline">
                        <thead class="-shad-12 -shad-17-h">
                            <tr>
                                <th scope="col">
                                    {{'id'|trans}}
                                </th>
                                <th>
                                    {{'name'|trans}}
                                </th>
                                <th>
                                    {{'type'|trans}}
                                </th>
                                <th>
                                    {{'path'|trans}}
                                </th>
                                <th>
                                    {{'action'|trans}}
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for item in menu.menuItems %}
                                <tr class="-shad-12 -shad-14-h">
                                    <td scope="row" data-label="{{'id'|trans|upper}}">       
                                        {{item.id}}
                                    </td>
                                    <td data-label="{{'id'|trans|upper}}">       
                                        {{item.name}}
                                    </td>
                                    <td data-label="{{'type'|trans|upper}}">       
                                        {{item.type}}
                                    </td>
                                    <td data-label="{{'path'|trans|upper}}">
                                        {% if item.path  is defined and item.path is not null and item.path != ""%}
                                            {% if item.type == 'page' %}
                                                {% set itemPath = path('page_show', {'pageUrl': item.path}) %}
                                            {% endif %}
                                            {% if item.type == 'internal' %}
                                                {% set itemPath = path(item.path) %}
                                            {% endif %}
                                            {% if item.type == 'external' %}
                                                {% set itemPath = item.path %}
                                            {% endif %}
                                        {% else %}
                                            {% set itemPath = "#" %}
                                        {% endif %}
                                        <a 
                                            target="_blanck"
                                            href="{{itemPath}}"
                                        >
                                            {{item.path|slice(0, 20)}}
                                        </a>
                                    </td>
                                    <td data-label="{{'actions '|trans|upper}}">
                                        {% include 'liquid-ui/components/ui/buttons/btn-action.html.twig' with {
                                            'path': path('editor_menu_item_edit', { 'menuItemId': item.id, 'menuId': menu.id, 'type': item.type }),
                                            'action': 'edit',
                                            'tooltip': 'edit',
                                            'icon': 'fas fa-edit'
                                        } %}
                                        {% include 'liquid-ui/components/ui/buttons/btn-delete.html.twig' with {
                                            'path': path('editor_menu_item_delete', { 'menuItemId': item.id, 'menuId': menu.id  }),
                                            'message': 'Do you want to delete this menu item ?' ,
                                            'token': 'delete-menu-item'
                                        } %}
                                    </td>
                                </tr>
                            {% endfor %}       
                        </tbody>
                    </table>
                </section>
            {% endif %}            
        </section>
    {% endif %}
{% endblock %}



